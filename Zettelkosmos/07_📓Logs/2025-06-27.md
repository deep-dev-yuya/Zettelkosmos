---
title: ログテンプレート（日次）
tags: [log, daily, templater]
type: log
status: draft
created: 2025-06-28
updated: 2025-06-28
---

# 2025-06-27 金

## 🔁 前後リンク
- ← [[2025-06-27]]
- → [[2025-06-29]]

## ✅ タスク
- [x]  Gmail受信を LINE通知用に構成
- [x] 長文の文字化けを防止する為に本文を500文字制限

## 📝 メモ・気づき
- - フィールド右上にある小さな `Fixed / Expression` トグルで切り替えることで、埋め込み式（ `{{ $json.xxx }}` ）を正しく使えるようになった。
## 📌 振り返り
- 良かったこと：トライアンドエラーで LINE通知が理想のかたちに仕上げられた
- 改善点：まだ実装直後なので今後も細かい修正を行なっていく
- 明日やること：GeminiCLIの基本操作とXのPostを LINE通知のワークフロー作成

##  💻AIからの振り返り

### 🛠️ 実施内容
- n8nで **Gmail受信メールをLINEへ通知するワークフロー** を構築。
- トリガーは `IMAP（Gmail Watcher）` を使用。
- 通知先は **LINE Messaging API（push message）**。
- エンコード補正 → フィルタ → LINE通知文作成 → HTTP送信 の4段階構成に整理。

### 🧠 学びと気づき

- **Expressionモードの切り替え**がようやく理解できた。
  - 今までは「入力欄にJSONや式が入らない」状態で詰まっていた。
  - フィールド右上にある小さな `Fixed / Expression` トグルで切り替えることで、埋め込み式（ `{{ $json.xxx }}` ）を正しく使えるようになった。
  - 過去にもAIに言われていたが「UI上の配置に気づけず見落としていた」と自己分析。

- **LINE push API用JSON構造の正確な把握**ができた。
  - `to`（ユーザーID）と `messages`（配列）を **正しい形式で**送る必要がある。
  - JSON構造の `Value` 内に式を入れる際、「文字列の中に式を入れると全体が文字列になる」ことに注意。
  - 正しくは：  
    ```json
    "messages": [ { "type": "text", "text": "{{ $json.messages[0].text }}" } ]
    ```

### 🎯 今回成功できた決め手（AI視点）

1. **式埋め込みのミスを一つ一つ明示的に修正**できたこと。
   - 以前は「式が文字列扱い」になるケースで見落としがあった。
   - 今回は `"text": "{{ ... }}"` の `" "` の扱いと中の `{{ ... }}` の意味を明確に分離できていた。

2. **Header構成を正確に入力**
   - `Authorization` → `Bearer <チャネルアクセストークン>` の構成でコピペミスや空白などを防げた。

3. **「Bad request」時のエラー内容（プロパティ名や空欄指摘）を読解し、修正に生かせた。**
   - `messages may not be empty` → `messages`の指定忘れ。
   - `Invalid character in header` → 値の形式や改行ミスを疑うなど、冷静に分解できた。

4. **ノード構成を論理的に整理していた**
   - `Fix Encoding`（文字化け対応）→ `Email Filter`（条件絞り込み）→ `LINE Message Builder`（整形）→ `Send to LINE`（送信）と、明快な処理分担により原因の切り分けが容易だった。

### ✅ 結果

- 通知は **LINE上で読みやすく整った形式**で成功！
- テスト用に送ったメールが、整形されてメッセージカードのように表示され満足度が高い。

---